<!DOCTYPE html>
<html>
<head>
    <title>Select Columns and Set Attributes</title>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        var lRadio = document.getElementById('l_diversity');
        var kRadio = document.getElementById('k_anonymity');
        var lDivContainer = document.getElementById('l_div_container');
        function toggleLDiv() {
           if(lRadio.checked) {
               lDivContainer.style.display = 'block';
           } else {
               lDivContainer.style.display = 'none';
           }
        }
        lRadio.addEventListener('change', toggleLDiv);
        kRadio.addEventListener('change', toggleLDiv);
        toggleLDiv(); // initialize on page load
      });
    </script>
</head>
<body>
    <h1>Select Columns for Further Processing</h1>
    
    <!-- Inline flash messages for warnings -->
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <div class="flash-messages">
          {% for message in messages %}
            <p style="color: red;">{{ message }}</p>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}
    
    <h2>Uploaded CSV Preview (First 10 Rows)</h2>
    <div>
        {{ original_preview|safe }}
    </div>
    
    <p>For each column in your CSV, select its role and (if applicable) its hierarchy type:</p>
    <form method="post">
        <table border="1" cellpadding="5" cellspacing="0">
            <tr>
                <th>Column</th>
                <th>Role</th>
                <th>Hierarchy Type</th>
            </tr>
            {% for col in columns %}
            <tr>
                <td>{{ col }}</td>
                <td>
                    <select name="{{ col }}">
                        <option value="none">Ignore</option>
                        <option value="quasi">Quasi-Identifier</option>
                        <option value="ident">Identifier</option>
                        <option value="sensitive">Sensitive Attribute</option>
                    </select>
                </td>
                <td>
                    {% if col_types[col] == "numeric" %}
                      <select name="hier_{{ col }}">
                          <option value="none">None</option>
                          <option value="interval5">Interval (5)</option>
                          <option value="interval10">Interval (10)</option>
                      </select>
                    {% else %}
                      <select name="hier_{{ col }}">
                          <option value="none">None</option>
                          <option value="substring">Substring</option>
                          <option value="suppression">Suppression</option>
                      </select>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </table>
        <br>
        <!-- Input fields for k and suppression level -->
        <label for="k">Enter k value:</label>
        <input type="number" name="k" min="1" required>
        <br><br>
        <label for="supp_level">Enter Suppression Level:</label>
        <input type="number" name="supp_level" min="0" required>
        <br><br>
        <!-- Radio buttons for method selection -->
        <label>Choose anonymization method:</label><br>
        <input type="radio" name="method" value="k_anonymity" id="k_anonymity" checked>
        <label for="k_anonymity">K-Anonymity</label><br>
        <input type="radio" name="method" value="l_diversity" id="l_diversity">
        <label for="l_diversity">L-Diversity</label><br><br>
        <!-- Additional input for l value, shown only when l-diversity is selected -->
        <div id="l_div_container" style="display: none;">
          <label for="l_div">Enter l value for L-Diversity:</label>
          <input type="number" name="l_div" min="1">
          <br><br>
        </div>
        <input type="submit" value="Process">
    </form>
</body>
</html>
